<html>
  <head>
    <style type="text/css">
    </style>
  </head>
  <body>
    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="/jquery.mousewheel.js"></script>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      var socket = io.connect("/");
      var MOUSE_BUTTONS = {
        1: "left", 
        2: "middle", 
        3: "right"
      };

      function makeMouseHandler(action) {
        return function(e) {
          var data = {
            "pX": e.pageX / $(document).width(),
            "pY": e.pageY / $(document).height(),
            "btn": e.which ? MOUSE_BUTTONS[e.which] : null,
          };
          socket.emit(action, data);
        };
      }

      $(document).mousemove(makeMouseHandler("mousemove"));
      $(document).mousedown(makeMouseHandler("mousedown"));
      $(document).mouseup(makeMouseHandler("mouseup"));

      $(document).bind("contextmenu", function(e) {
          e.preventDefault();
          return false;
      });

      function makeKeyHandler(action) {
        return function(e) {
          socket.emit(action, { keyCode: e.which });
          e.stopPropagation();
          e.preventDefault();
          return false
        };
      }
      $(document).keydown(makeKeyHandler("keydown"));
      $(document).keyup(makeKeyHandler("keyup"));

      $(document).mousewheel(function(e, deltaX, deltaY) {
          if (deltaY !== 0) {
            socket.emit("scrollX", deltaY);
          }
          if (deltaX !== 0) {
            socket.emit("scrollY", deltaX);
          }
          e.preventDefault();
          return false;
      });
    </script>
  </body>
</html>
