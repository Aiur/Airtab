<html>
  <head>
    <style type="text/css">
    </style>
  </head>
  <body>
    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      var socket = io.connect("/");
      var MOUSE_BUTTONS = {
        1: "left", 
        2: "middle", 
        3: "right"
      };

      function makeMouseHandler(action) {
        return function(e) {
          var data = {
            "ctrl": e.ctrlKey,
            "shift": e.shiftKey,
            "alt": e.alt,
            "cmd": e.metaKey,
            "pX": 100 * e.pageX / $(document).width(),
            "pY": 100 * e.pageY / $(document).height(),
            "btn": e.which ? MOUSE_BUTTONS[e.which] : null,
          };
          socket.emit(action, data);
          console.log(action);
          console.log(data);
        };
      }

      $(document).mousemove(makeMouseHandler("mousemove"));
      $(document).mousedown(makeMouseHandler("mousedown"));
      $(document).mouseup(makeMouseHandler("mouseup"));

      function makeKeyHandler(action) {
        return function(e) {
          socket.emit(action, { keyCode: e.which });
          e.stopPropagation();
          e.preventDefault();
          console.log(action +": " + e.which);
          return false
        };
      }
      $(document).keydown(makeKeyHandler("keydown"));
      $(document).keyup(makeKeyHandler("keyup"));
    </script>
  </body>
</html>
